@model List<TESTER.Models.Event>
@{
    ViewBag.Title = "Events & Announcements";
    var recommended = ViewBag.Recommended as List<TESTER.Models.Event>;
    if (recommended == null) { recommended = new List<TESTER.Models.Event>(); }

    var recent = ViewBag.Recent as List<TESTER.Models.Event>;
    if (recent == null) { recent = new List<TESTER.Models.Event>(); }
}

    <h2 style="text-align:center; margin-bottom:20px;">Events & Announcements</h2>

    <!-- Search Section -->
    <form method="get" action="@Url.Action("LocalEvents", "Home")" style="text-align:center; margin-bottom:25px;">
        <input type="text" name="search" placeholder="Search by category..."
               value="@ViewBag.CurrentSearch"
               style="padding:8px; border:1px solid gray; border-radius:6px; width:180px; margin-right:10px;" />
        <!-- Start date selecter -->
        <label>Start Date:</label>
        <input type="date" name="startDate" value="@ViewBag.CurrentStartDate"
               style="padding:8px; border:1px solid gray; border-radius:6px; margin-right:10px;" />
        <!-- End date selecter -->
        <label>End Date:</label>
        <input type="date" name="endDate" value="@ViewBag.CurrentEndDate"
               style="padding:8px; border:1px solid gray; border-radius:6px; margin-right:10px;" />
        <!-- Search -->
        <button type="submit"
                style="background-color:#007bff; color:white; border:none; padding:10px; border-radius:6px; cursor:pointer; margin-right:8px;">
            Search
        </button>

   
        <a href="@Url.Action("LocalEvents", "Home")"
           style="background-color:#28a745; color:white; border:none; padding:10px 15px; border-radius:6px; cursor:pointer; text-decoration:none;">
            Refresh / Show All Events
        </a>
    </form>

    <!--Recomenned events -->
@if (recommended.Count > 0)
{
        <h3 style="text-align:center;"> Recommended for You</h3>
        <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:15px; margin-top:15px;">
            @foreach (var e in recommended)
            {
                <div style="border:1px solid #ccc; border-radius:10px; padding:10px; background-color:#fdfdfd; box-shadow:0 3px 5px rgba(0,0,0,0.1);">
                    <h4>@e.Title</h4>
                    <p><b>Date:</b> @e.Date.ToString("MMMM dd, yyyy")</p>
                    <p><b>Category:</b> @e.Category</p>
                    <a href="@Url.Action("ViewEvent", "Home", new { id = e.Id })" style="color:#007bff;">View Details</a>
                </div>
            }
        </div>
}

    <!-- Recently Viewed -->
@if (recent.Count > 0)
{
        <h3 style="margin-top:30px; text-align:center;">Recently Viewed</h3>
        <div style="display:flex; justify-content:center; flex-wrap:wrap; gap:10px; margin-top:10px;">
            @foreach (var e in recent)
            {
                <div style="border:1px solid #ddd; background-color:#fafafa; border-radius:6px; padding:8px 10px;">
                    <b>@e.Title</b><br />
                    <small>@e.Date.ToShortDateString() - @e.Category</small>
                </div>
            }
        </div>
}

    <!--Display all Events -->
    <h3 style="margin-top:35px; text-align:center;">All Events</h3>
    <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:20px; margin-top:20px;">
        @if (Model != null && Model.Count > 0)
        {
            @foreach (var e in Model)
            {
                <div style="border:1px solid #ccc; border-radius:10px; padding:12px; background:#fff; box-shadow:0 3px 6px rgba(0,0,0,0.1);">
                    <h4>@e.Title</h4>
                    <p><b>Date:</b> @e.Date.ToString("MMMM dd, yyyy")</p>
                    <p><b>Category:</b> @e.Category</p>
                    <a href="@Url.Action("ViewEvent", "Home", new { id = e.Id })" style="color:#007bff;">View Details</a>
                </div>
            }
        }
        else
        {
            <p style="text-align:center;">No events found.</p>
        }
    </div>
    <!-- EOF -->
